{% extends 'main/base.html' %}
{% load static i18n %}

{% block title %}Lêgerîn - {{ query }}{% endblock %}

{% block content %}
<div class="container twitter-container">
    <!-- Arama Formu -->
    <div class="search-container mb-4">
        <form method="get" action="{% url 'search' %}">
            <div class="input-group">
                <input type="text" 
                       name="q" 
                       class="form-control" 
                       placeholder="{% trans 'Ara...' %}" 
                       aria-label="{% trans 'Arama' %}" 
                       autocomplete="off"
                       value="{{ query }}"
                       data-search-input>
                <button class="search-btn btn btn-primary" type="submit">
                    <i class="bi bi-search"></i>
                </button>
                <div class="search-suggestions" data-search-suggestions></div>
            </div>
        </form>
    </div>

    <!-- Mevcut Arama Sonuçları -->
    <div class="fade-in">
        <h3 class="mb-4">"{{ query }}" ji bo Encaman</h3>
    </div>
    
    {% if results.users %}
        <div class="fade-in">
            <h4 class="border-bottom pb-2 mb-3">Bikarhêner</h4>
        </div>
        {% for profile in results.users %}
            <div class="card mb-2 fade-in">
                <div class="card-body p-3">
                    <p class="mb-1">
                        <strong>{{ profile.nickname }}</strong> 
                        <span class="text-muted">@{{ profile.username }}</span>
                    </p>
                </div>
            </div>
        {% empty %}
            <p class="text-muted">Bikarhêner nehat dîtin.</p>
        {% endfor %}
    {% endif %}

    {% if results.ids %}
        <div class="fade-in">
            <h4 class="border-bottom pb-2 mb-3">Nasname (ID)</h4>
        </div>
        {% for post in results.ids %}
            <div class="card mb-2 fade-in">
                <div class="card-body p-3">
                    <p class="mb-1">
                        <strong>{{ post.user.profile.nickname }}</strong> 
                        <span class="text-muted">@{{ post.user.profile.username }} · {{ post.short_id }} · {{ post.created_at|timesince }}</span>
                    </p>
                    <div class="post-text">
                        {{ post.text|linebreaks }}
                    </div>
                    <a href="{% url 'post_detail' post.id %}" class="text-primary small">Zêdetir bixwîne</a>
                </div>
            </div>
        {% empty %}
            <p class="text-muted">Nasname (ID) nehat dîtin.</p>
        {% endfor %}
    {% endif %}

    {% if results.posts %}
        <div class="fade-in">
            <h4 class="border-bottom pb-2 mb-3">Post</h4>
        </div>
        {% for post in results.posts %}
            <div class="card mb-2 fade-in">
                <div class="card-body p-3">
                    <p class="mb-1">
                        <strong>{{ post.user.profile.nickname }}</strong> 
                        <span class="text-muted">@{{ post.user.profile.username }} · {{ post.short_id }} · {{ post.created_at|timesince }}</span>
                    </p>
                    <div class="post-text">
                        {{ post.text|linebreaks }}
                    </div>
                    <a href="{% url 'post_detail' post.id %}" class="text-primary small">Zêdetir bixwîne</a>
                </div>
            </div>
        {% empty %}
            <p class="text-muted">Post nehat dîtin.</p>
        {% endfor %}
    {% endif %}

    {% if not results.users and not results.ids and not results.posts %}
        <div class="fade-in">
            <p class="text-muted">Tu encam nehat dîtin.</p>
        </div>
    {% endif %}
</div>
{% endblock %}